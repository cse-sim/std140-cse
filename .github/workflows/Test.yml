name: Test

on: push

jobs:
  test-std140:
    name: Test std140
    runs-on: windows-2022
    defaults:
      run:
        shell: cmd
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Install ruby
        uses: ruby/setup-ruby@v1
        with:
          ruby-version: '3.0'
      - name: Install modelkit  # Install modelkit
        run: |
          curl https://share.bigladdersoftware.com/files/modelkit-caboodle-0.9.0-flannel+caboodle.22.a701d43.exe --output ./modelkit-installer.exe
          mkdir modelkit-folder
          modelkit-installer.exe /VERYSILENT /DIR=./modelkit-folder/
          copy .\modelkit-folder\bin\modelkit.bat .
          echo "$HOME/modelkit.bat" >> $GITHUB_PATH
      - name: Test path
        run: |
          PATH
          dir
          echo "$GITHUB_PATH"
      - name: Run-test
        shell: cmd
        run: |
          modelkit.bat
          rake
      