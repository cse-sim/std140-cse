name: Test

on: push

jobs:
  test-std140:
    name: Test std140
    runs-on: windows-2022
    defaults:
      run:
        shell: pwsh
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Install modelkit  # Install modelkit
        run: |
          curl https://share.bigladdersoftware.com/files/modelkit-caboodle-0.9.0-flannel+caboodle.22.a701d43.exe --output ./modelkit-installer.exe
          mkdir modelkit-folder
          .\modelkit-installer.exe /SP- /VERYSILENT /DIR=.\modelkit-folder
      - name: Add modelkit to path
        run: |
          echo "$env:GITHUB_PATH"
          "$env:HOMEPATH\modelkit-folder\bin" >> $env:GITHUB_PATH
      - name: Run rake test
        run: |
          echo $env:GITHUB_PATH
          echo $env:path
          modelkit --help
          rake
      # copy .\modelkit-folder\bin\modelkit.bat .
      # - name: Install ruby
      #   uses: ruby/setup-ruby@v1
      #   with:
      #     ruby-version: '3.0'